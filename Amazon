http://a/b testingTEAM RESULT ----- ------ A WIN A LOSS A WIN B WIN B LOSS C WIN D LOSS E DRAW C DRAW TEAM WINS LOSS DRAW TOTAL SELECT TEAM , CASE WHEN RESULT = 'WIN' SELECT COUNT('WIN') FROM RESULT AS 'WIN' CASE WHEN RESULT = '' COUNT(LOSS) FROM RESULT AS 'LOSS', SELECT COUNT(DRAW) FROM RESULT AS 'Draw', (SELECT (COUNT(*) FROM RESULT AS 'Total') #Revenue by customer in the last 6 months Orders Order_id|Customer_id|prodcut_id|quantity|cost|product_group|order_date SELECT (cost*quantity) AS 'Revenue' FROM Orders WHERE order_date < GROUP BY (Customer_id) string = f'SELECT (cost * quantity) AS 'Revenue' FROM Orders GROUP BY (Customer_id) ' b = cx_Oracle.execute(string).fetchall() date = datetime.dateime.now() year = date[6:] ls = [] for x in b: if x > date - f'00-06-{year}': ls.append(x) print(ls) a = [0001,] x = '{ "order_id " : 0001, "Customer_id": 0001, "product_id": "ABC123", "quantity": 30 , "cost":75 , "product_group":"Sustain123","order_date":"January-23-2019" }' for x in x: if x["order_id"] not in a: xl.append(x["order_id"][x], x["order_id"][x]["Customer_id"], x["order_id"][x]["product_id"], ["order_id"][x]["quantity"], ["order_id"][x]["cost"] , ["order_id"][x]["product_group"], ["order_id"][x]["order_date"] xl.write.csv("test")
